
addpath(genpath('~/Documents/master/masterarbeit/matlab'));

clear;
iscase = 'q2_200_d080'

load([iscase '_vel']);


% Further Geometry 

[r_,phi_]     = meshgrid(r,phi);
[x_dat,y_dat] = pol2cart(phi_,r_);

Nlat=length(lat);
ilat=Nlat/2;
%% PLOTS
ilat=Nlat/2;

f1=figure('name','Contour-Plot', 'visible','on');
f1.Units='centimeters';
set(f1, 'Position', [1, 3, 15.,15.]);
set(f1,'PaperPositionMode','auto');
set(f1,'PaperOrientation','landscape');

contour(x_dat,y_dat,squeeze(V.mean.r(:,:,ilat))',30);
t=title([name ' Radial Velocity'],'interpreter','none');
set(t,'FontSize',12);
axis square;
shading flat;
h = colorbar('eastoutside');

% position2=[0.33,0.,0.3,0.3];
subplot(1,3,2);
contour(x_dat,y_dat,squeeze(V.mean.p(:,:,ilat))',30);
t=title([name ' Azimuthal Velocity'],'interpreter','none');
set(t,'FontSize',12);
axis square;
shading flat;
h = colorbar('eastoutside');
% 
% position3=[0.66,0.,0.3,0.3];
subplot(1,3,3);
contour(x_dat,y_dat,squeeze(V.mean.t(:,:,ilat))',30);
t=title([name ' Theta Velocity'],'interpreter','none');
set(t,'FontSize',12);
axis square;
shading flat;
h = colorbar('eastoutside');
 
% % this part of the script adjusts the paper size of the pdf-output
% ti = get(gca,'TightInset');
% set(gca,'Position',[ti(1) ti(2) 1-ti(3)-ti(1) 1-ti(4)-ti(2)]);
% 
% set(gca,'units','centimeters')
% pos = get(gca,'Position');
% ti = get(gca,'TightInset');
% 
% set(gcf, 'PaperUnits','centimeters');
% set(gcf, 'PaperSize', [pos(3)+ti(1)+ti(3) pos(4)+ti(2)+ti(4)]);
% set(gcf, 'PaperPositionMode', 'manual');
% set(gcf, 'PaperPosition',[0 0 pos(3)+ti(1)+ti(3) pos(4)+ti(2)+ti(4)]);
% %end paper size adjustment


saveTightFigure(f1,[name '.pdf'])


%% PLOT symmetry

 V.p_ = V.p_/double(Nlong);


differ = max(V.p_) - min(V.p_);
differ=differ/2;

V.p_ = V.p_ + ( differ - max(V.p_));


% f2=figure('name', [name 'azimuthal symmetry'],'visible','off');
f2=figure('name', [name 'azimuthal symmetry'],'visible','on');

plot(r,V.p_);
title(name, 'interpreter','none','FontSize',20);

% title(name,'interpreter','none','FontSize',20);
xlabel('Radial position','FontSize',20);
ylabel('azimuthal mean','FontSize',20);




saveTightFigure(f2,[name '_sym.pdf'])